堆上分配内存

1. 堆是什么？
2. 如何在堆上分配内存
    
    使用 new 键值对配合指针使用 即可在堆上分配内存
    
    2. 单个对象分配
    3. 分配数组
3. 如何在堆上释放内存

存储 动态分配的内存数据 等信息的区域  
由程序员手动管理，需要主动分配、主动释放  
生命周期不固定，由程序员决定生死  
语法：  
变量类型* 指针名 = new 变量类型(初始值（可选）)  
作用：  
new 的作用就是“开房”（分配内存房间，门牌号，和具体的内存容量）  
注意：  
指针变量本质上还是在栈上，只是其中存储的地址是堆上的地址  
指针变量本身还是由系统管理，我们需要手动管理的是他指向的地址

|                                                                                                                                                                                           |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| int* p = new int(10);  <br>cout \<\< p \<\< '\n';//地址记录的是在堆区开辟的内存空间  <br>cout \<\< *p \<\< '\n';//打印的是堆区开辟的内存空间中存储的数据10  <br>*p = 20;  <br>cout \<\< *p \<\< '\n';//打印的是堆区开辟的内存空间中存储的数据20 |

语法：  
数组类型* 指针名 = new 数据类型[容量]{初始值（可选）}  
作用：  
new 的作用同样是“开房”（分配n个连续的内存空间，具体是否初始化房间里的值，由自己决定）  
这时候指针 arr 相当于就是数组名

|                                                                                                                                                                                                                   |
| ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| int* arr = new int[10] {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};  <br>cout \<\< arr[1] \<\< '\n';  <br>int(* arr2)[5] = new int[2][5]{ { 10, 11, 12, 13, 14 }, {15,16,17,18,19} };  <br>cout \<\< (*(arr2+1))[1] \<\< '\n'; |

使用 delete 键值 即可在堆上分配内存  
语法:  
delete 指针变量 — 配对 new  
delete[] 数组变量 — 配对 new[]  
作用:  
delete 的作用就是释放通过 new 在堆上分配的动态内存，但是指针仍在栈上  
注意:  
delete 的作用并不是销毁指针变量本身，而是销毁指针变量指向的堆内存

|                                                                                                                                                                                                                                                                                                                                                                       |
| --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| int* p = new int(10);  <br>int* arr = new int[10] {0, 1, 2, 3, 4, 5, 6, 7, 8, 9};  <br>cout \<\< arr[1] \<\< '\n';  <br>int(*arr2)[5] = new int[2][5]{ { 10, 11, 12, 13, 14 }, {15,16,17,18,19} };  <br>cout \<\< (*(arr2+1))[1] \<\< '\n';  <br>delete p;  <br>p = nullptr;//指针置空，防止出现野指针  <br>delete[] arr;//释放数组时一定要加[]，否则只会释放第一个元素，会造成内存泄漏或奔溃  <br>arr = nullptr; |