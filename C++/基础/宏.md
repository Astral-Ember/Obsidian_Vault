宏

1. 知识点回顾：什么是编译器
2. 什么是预处理指令
3. 宏的基本概念
4. 宏的使用 不带参数的宏
5. 宏的使用 带参数的宏
6. 取消宏定义
7. 宏的使用 定义一个符号
8. 宏的优缺点

编译器是一种翻译程序  
它用于将 源语言程序 翻译为 目标语言程序  
源语言程序：某种程序设计语言写成的，如 C++、C、C#, Java 等语言写的程序  
目标语言程序：机器代码或中间代码，让计算机等可以识别理解的内容
 
预处理器指令 指导编译器 在实际编译开始之前对信息进行预处理  
预处理器指令 都是以 # 开始  
预处理器指令不是语句，所以它们不以分号结束  
目前我们经常用到的 [折叠代码块](折叠代码块.md) 就是预处理器指令  
宏就是一种预处理指令  
它的主要作用就是在编译之前 替代源代码中的信息  
类似一连串信息的别名（信息可以是数值、字符串、表达式等）  
宏主要通过  
#define 指令来创建  
分为 不带参数的宏 和 带参数的宏  
使用注意：  
一般写在代码文件的最上方（#include 下方）  
宏名一般全为大写  
不需要在行末加分号  
基本语法  
#define 宏名 用于替代的信息  
主要作用  
定义常量或简化代码的重复部分

|   |
|---|
|#include\<iostream\>  <br>#include\<string\>  <br>#define PI 3.1415926  <br>#define MAX_SIZE 100  <br>#define COUT_HELLO cout\<\<"hello world"\<\<endl  <br>#define INFO "information"  <br>using namespace std;  <br>int main()  <br>{  <br>cout\<\<PI\<\<endl;//输出3.14159  <br>COUT_HELLO;//输出hello world  <br>}|

基本语法  
#define 宏名(参数) 参数使用表达式  
主要作用  
简化表达式、 代码重用、 条件表达式、 避免函数调用开销  
注意事项  
使用带参数的宏时要小心，因为它们不会进行类型检查相对来说，[内联函数](内联函数.md)更安全  
表达式中括号的重要性

|   |
|---|
|#define MUL(x,y) x*y  <br>#define ADD(x,y) x+y  <br>using namespace std;  <br>int main()  <br>{  <br>cout\<\<MUL(ADD(2,3),4)\<\<endl;//等价于2+3*4  <br>cout \<\< MUL((ADD(2, 3)), 4) \<\< endl;//等价于(2+3)*4  <br>}|

undef 宏  
undef用于取消宏  
主要在宏定义符号时使用  
基本语法  
#define 符号  
主要作用  
定义一个符号，类似一个没有值的变量  
可以配合编译指令  
#ifdef 宏  
#elif defined(宏）  
#else  
#endif  
用宏来决定编译哪些代码  
可以利用它来区分不同板块执行不同的代码等功能

|   |
|---|
|#define UE5  <br>#define UE4  <br>using namespace std;  <br>int main()  <br>{  <br>#ifdef UE5//如果有UE5定义  <br>cout\<\<"UE5"\<\<endl;  <br>#elif defined UE4//如果有UE4定义  <br>cout\<\<"UE4"\<\<endl;  <br>#else//否则  <br>cout\<\<"Not UE"\<\<endl;  <br>#endif//结束  <br>}|

优点：

1. 简化代码
2. 条件编译
3. 消除函数调用的开销
4. 灵活性（没有类型限制）
5. 便于全局修改

等等

缺点：

1. 增加调试难度
2. 没有类型检查
3. 命名冲突
4. 缺乏作用域
5. 可读性下降

宏在代码中展开，调试时可能难以追踪错误，错误信息可能不够清晰  
可能会与其他变量或函数名冲突  
宏没有作用域限制，它们在整个文件中有效  
过度使用宏，尤其是在复杂的宏定义中，可能会导致理解和维护变得困难  
宏虽然看起来很有用  
但是在开发中如果可以被常量、内联函数 、枚举等功能替代宏功能时 就不要使用宏了