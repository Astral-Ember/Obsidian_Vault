从摄像机发射一条射线，到EndLocation（EndLocation=ViewPointLocation+ViewPointRotation.Vector()* MaxRange

创建新的追踪通道
![[Pasted image 20251130132646.png]]

在CPP中实现射线检测
```
void AGun::PullTrigger()
{
	if (OwnerController)
	{
		/**
		 * 从玩家视角发射一条射线进行碰撞检测
		 *
		 * 该函数获取玩家当前的视角位置和朝向，绘制调试相机标记，
		 * 然后从视角位置沿视线方向发射一条指定最大距离的射线，
		 * 检测与场景中物体的碰撞情况。
		 *
		 * @param ViewPointLocation 输出参数，返回玩家视角的世界坐标位置
		 * @param ViewPointRotation 输出参数，返回玩家视角的世界旋转角度
		 * @param HitResult 输出参数，返回射线检测的碰撞结果信息
		 * @param Params 碰撞查询参数，用于过滤需要忽略的实体
		 */
		FVector ViewPointLocation;
		FRotator ViewPointRotation;

		// 获取玩家当前的视角位置和旋转信息
		OwnerController->GetPlayerViewPoint(ViewPointLocation, ViewPointRotation);

		// 在世界中绘制调试相机标记，用于可视化调试
		DrawDebugCamera(GetWorld(), ViewPointLocation, ViewPointRotation, 90.0f, 2, FColor::Red, true);

		FHitResult  HitResult;
		FCollisionQueryParams Params;

		// 设置碰撞查询参数，忽略当前actor和其拥有者，避免自相交检测
		Params.AddIgnoredActor(this);
		Params.AddIgnoredActor(GetOwner());

		// 执行单次射线检测，从视角位置沿视线方向发射射线进行碰撞检测
		GetWorld()->LineTraceSingleByChannel(HitResult, ViewPointLocation,
			ViewPointLocation + ViewPointRotation.Vector() * MaxRange, ECC_GameTraceChannel2, Params);
	}
}
```
ECC_GameTraceChannel2参数的获取是在这个文件中搜索刚刚创建的追踪通道
![[Pasted image 20251130134029.png]]